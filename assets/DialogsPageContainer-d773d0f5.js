var c=Object.defineProperty;var h=(s,t,a)=>t in s?c(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var r=(s,t,a)=>(h(s,typeof t!="symbol"?t+"":t,a),a);import{j as e,N as u,c as x,u as w,R as m,p as N,F as j,q as I,r as M,a as P,b as f,s as v,t as A,v as T,x as C,y as _,w as b}from"./index-2123739f.js";const O="dialogs--fKVdy",p="dialogsTitle--1Bk9S",D="dialogsContent--9jNEG",F="dialogsColumn---pywJ",E="messagesColumn--cciqV",k="messagesItems--wcKTd",i={dialogs:O,dialogsTitle:p,dialogsContent:D,dialogsColumn:F,messagesColumn:E,messagesItems:k},y="dialogItem--PWWf-",L="NavLink--7wDcD",R="dialogItemActive--1wrMj",g={dialogItem:y,NavLink:L,dialogItemActive:R},W=s=>e.jsx("p",{className:g.dialogItem,children:e.jsx(u,{to:"/dialogs/"+s.id,className:g.NavLink,activeClassName:g.dialogItemActive,children:s.name})}),U=s=>{const t=s.dialogs.map(a=>e.jsx(W,{name:a.name,id:a.id},a.id));return e.jsx("div",{children:t})},B="messageWrapper--MT-7Z",S="owner--uo73L",$="messageAuthor--KErZT",q="messageAuthorPhoto--f3-yQ",z="messageAuthorName--2tLAd",V="messageText--XETkG",K="messageAuthorPhotoOwner--9e-wN",G="messageTextOwner--7xrsc",n={messageWrapper:B,owner:S,messageAuthor:$,messageAuthorPhoto:q,messageAuthorName:z,messageText:V,messageAuthorPhotoOwner:K,messageTextOwner:G},Z=s=>s.name=="Я"?e.jsxs("div",{className:x(n.messageWrapper,n.owner),children:[e.jsxs("div",{className:n.messageAuthor,children:[e.jsx("div",{className:n.messageAuthorPhotoOwner,children:e.jsx("img",{src:s.photos||w,alt:""})}),e.jsx("div",{className:n.messageAuthorName,children:s.name})]}),e.jsx("p",{className:n.messageTextOwner,children:s.messageText})]}):e.jsxs("div",{className:n.messageWrapper,children:[e.jsxs("div",{className:n.messageAuthor,children:[e.jsx("div",{className:n.messageAuthorPhoto}),e.jsx("div",{className:n.messageAuthorName,children:s.name})]}),e.jsx("p",{className:n.messageText,children:s.messageText})]});class J extends m.Component{constructor(){super(...arguments);r(this,"scrollToBottom",()=>{this.messagesEnd.scrollIntoView({behavior:"smooth"})})}componentDidUpdate(){this.scrollToBottom()}getDialogId(){return this.props.dialogId?this.props.dialogId:0}getMessagesItems(){const a=[...this.props.dialogsMessages.filter(l=>l.id==+this.getDialogId())];if(a.length>0)return a[0].messages.map(o=>e.jsx(Z,{name:o.name,messageText:o.messagesText,id:o.id,photos:this.props.photos},o.id))}render(){return e.jsxs("div",{id:"toBottom",children:[this.getMessagesItems(),e.jsx("div",{style:{float:"left",clear:"both"},ref:a=>{this.messagesEnd=a}})]})}}const Q="newPosts--jEBrd",X="newPosts__title--Peqrj",H="newPosts__text--99fxb",Y="newPosts__button--6ivdz",d={newPosts:Q,newPosts__title:X,newPosts__text:H,newPosts__button:Y},ss=s=>e.jsxs("form",{className:d.newPosts,onSubmit:s.handleSubmit,children:[e.jsx("label",{htmlFor:"newMessage"}),e.jsx(j,{className:d.newPosts__text,component:"textarea",name:"newMessage",validate:[I],placeholder:"моє повідомлення.."}),e.jsx("button",{className:`button ${d.newPosts__button}`,children:"Відправити"})]}),es=N({form:"DialogsAddNewMessage",enableReinitialize:!0,destroyOnUnmount:!1})(ss),ts=s=>{M.useEffect(()=>{s.resetNewMessageField()},[s.dialogId]);const t=()=>s.dialogsMessages.filter(o=>o.id==+s.dialogId)[0]!=null?s.dialogsMessages.filter(o=>o.id==+s.dialogId)[0].newMessageText:"",a=o=>{s.setCurrentTextOfMessage(o.newMessage,s.dialogId)},l=o=>{s.addNewMessage(o.newMessage,s.dialogId),console.log(o.newMessage)};return e.jsxs("div",{children:[e.jsx("p",{className:d.newPosts__title,children:"Нове повідомлення"}),e.jsx(es,{onSubmit:l,onChange:a,initialValues:{newMessage:t()}})]})},as=s=>e.jsxs("section",{className:i.dialogs,children:[e.jsx("p",{className:i.dialogsTitle,children:"Повідомлення"}),e.jsxs("div",{className:i.dialogsContent,children:[e.jsx("div",{className:i.dialogsColumn,children:e.jsx("div",{className:i.dialog,children:e.jsx(U,{...s})})}),e.jsxs("div",{className:i.messagesColumn,children:[e.jsx("div",{className:i.messagesItems,children:e.jsx(J,{...s,dialogId:s.dialogId})}),e.jsx(ts,{addNewMessage:s.addNewMessage,dialogId:s.dialogId,resetNewMessageField:s.resetNewMessageField,setCurrentTextOfMessage:s.setCurrentTextOfMessage,...s})]})]})]});class os extends m.Component{componentDidMount(){const t=this.props.authorizedUserId;this.props.getUserProfile(t)}render(){const t=this.props.match.params.dialogId;return console.log(t),e.jsx(as,{...this.props,dialogId:t})}}const ns=s=>({dialogs:s.dialogsPage.dialogs,dialogsMessages:s.dialogsPage.dialogsMessages,isAuth:s.auth.isAuth,authorizedUserId:s.auth.userId,photos:s.profilePage.profileInfo.photos.small}),ds=P(f(ns,{addNewMessage:v,getUserProfile:A,resetNewMessageField:T,setCurrentTextOfMessage:C.setCurrentTextOfMessage}),_,b)(os);export{ds as default};
